const demo = `
.......S.......
...............
.......^.......
...............
......^.^......
...............
.....^.^.^.....
...............
....^.^...^....
...............
...^.^...^.^...
...............
..^...^.....^..
...............
.^.^.^.^.^...^.
...............
`

const inputString = `
......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^...^....................................................................
.............................................................................................................................................
...................................................................^.^.^.^...................................................................
.............................................................................................................................................
..................................................................^...^.^.^..................................................................
.............................................................................................................................................
.................................................................^.^.^.....^.................................................................
.............................................................................................................................................
................................................................^.^...^.^...^................................................................
.............................................................................................................................................
...............................................................^...^.^.^.^.^.^...............................................................
.............................................................................................................................................
..............................................................^.^...^.^.^.^...^..............................................................
.............................................................................................................................................
.............................................................^.^.^...^.^.^...^.^.............................................................
.............................................................................................................................................
............................................................^...^.^.^.^...^.^...^............................................................
.............................................................................................................................................
...........................................................^.^.^.^...^...^...^...^...........................................................
.............................................................................................................................................
..........................................................^.^.^.^...^.....^.^.^.^.^..........................................................
.............................................................................................................................................
.........................................................^.^...^...^...^.^.^.....^.^.........................................................
.............................................................................................................................................
........................................................^.....^.^.^.^.^.^.^.^.^...^.^........................................................
.............................................................................................................................................
.......................................................^.^.^...^...^.....^...^.......^.......................................................
.............................................................................................................................................
......................................................^.^.^...^.......^.^.....^.^...^.^......................................................
.............................................................................................................................................
.....................................................^.^.^.^.....^.^.^.^...^.^...^.^.^.^.....................................................
.............................................................................................................................................
....................................................^.^.^.^.....^...^.^.^...^...^.^...^.^....................................................
.............................................................................................................................................
...................................................^.^...^.^.^.^.^.^.^.^...^.....^.^.^...^...................................................
.............................................................................................................................................
..................................................^.^.^.^.^...^.^.^.^.^.......^.^.^.^.^...^..................................................
.............................................................................................................................................
.................................................^.^.^.^.^.....^...^.^...^...^.^.^.^.^.^...^.................................................
.............................................................................................................................................
................................................^.^.^...^.^.^...^.^.......^.^.^.^.^.^.^.....^................................................
.............................................................................................................................................
...............................................^.^.^.^.^.....^...^.^...^...^.^.^.^.^.^...^.^.^...............................................
.............................................................................................................................................
..............................................^.....^.^...^.^.^.^.^...^.^.^.^.^.^.^.....^.^...^..............................................
.............................................................................................................................................
.............................................^.^.^.^.^...^.....^...^.^...^.^.^.....^.....^...^.^.............................................
.............................................................................................................................................
............................................^.^.^.^.^.^.^.^.....^.......^.^.^.^.^...^.^...^.^...^............................................
.............................................................................................................................................
...........................................^...^...^.^.....^.^.^.^...^...^.^.^.^...^.^.^.......^.^...........................................
.............................................................................................................................................
..........................................^.^.^.^.^.^.^.^.^.^.....^...^.....^.^.^.^.^.^.^.^.^...^.^..........................................
.............................................................................................................................................
.........................................^.^.^.^.^.^.......^...^.^.^.^.^.^.^...^...^.^.^.^.^.^.^...^.........................................
.............................................................................................................................................
........................................^.........^.^.....^.^.^.^.^...^.^...........^...^.^.^...^.^.^........................................
.............................................................................................................................................
.......................................^.^.^.^...^.^.^...^.^...^.^...^.^...^.^...^...^.^.^.........^.^.......................................
.............................................................................................................................................
......................................^.^.^.^.^.....^.^.^.^.^.^.^...^.^.^.^.........^...^...........^.^......................................
.............................................................................................................................................
.....................................^...^.....^...^.^.^.....^.....^...^.^...^.^.^...^.^.^.^...^.^.^.^.^.....................................
.............................................................................................................................................
....................................^.^.^.^.^...^...^...^.........^.^.^.^.^.^.^.^.^.^...^.^...^.^.......^....................................
.............................................................................................................................................
...................................^.^...^...........^.^.^.^...^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^...................................
.............................................................................................................................................
..................................^...^.^.^...^.....^.^.^...^.^.^.^.....^...^.^.^.....^.^...^.^.^...^.^.^.^..................................
.............................................................................................................................................
.................................^...^.^.^...^.^.^.^.^.^.^.^.^...^...^.^...^...^.....^...^...^.^...^.^...^.^.................................
.............................................................................................................................................
................................^.^.^.^...^.^.^...^.....^.^.....^...^...^.^...^.^.^.^...^.^.^.^.^.^...^.^.^.^................................
.............................................................................................................................................
...............................^...^.^...^.^.....^.^...^.^...^.^.^.......^.^.^.^...^...^.^.^.^.^.^.^.^...^.^.^...............................
.............................................................................................................................................
..............................^.^.^.^.^.^...^...^...^...^.^.^.^.^.....^.^.^.^...^.^.^.^.^.^...^.^...^.^...^.^.^..............................
.............................................................................................................................................
.............................^.^.^.^.^.......^.^.^.....^.^.........^.^.^...^.^.^.^.^.^.^.^.^.^.^...^...^.^...^.^.............................
.............................................................................................................................................
............................^.^.^.^.^.^.^.^.^...^...^.^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.......^............................
.............................................................................................................................................
...........................^.^...^...^.^.^.^.^...^.^.^.^...^...^...^.^.^.^.^.^...^.^.^...^...^.^.^...^.^...^...^.^...........................
.............................................................................................................................................
..........................^.....^...^.....^.^.^.^...^.^.^...^...^.^...^.^.^.^...^.....^.^.^...^.^.^...^.^.^.^...^.^..........................
.............................................................................................................................................
.........................^.^.^...^.^.^.^.^.^.^.^.^.^.^.....^...^.^...^.^.^.^...^...^.....^.^.^.....^...^.^.^.^.^.^.^.........................
.............................................................................................................................................
........................^.^...^.^...^.^.^...^...^.^...^.^.^...^.^.^.^.^.^.^.^.^.^...^...^...^.^.^.^.^.^.^.^.^.^.^.^.^........................
.............................................................................................................................................
.......................^.^...^.^.^.^.^.^.^.^.^.^.^.....^.^.^.^.^...^...^.^...^.^...^.^.^...^.^.^.........^...^.^.^...^.......................
.............................................................................................................................................
......................^.^.^.^...^...^.^.^...^.^.^.^.^.^.^.^.^.^...^.^.^...^...^.^...^.....^.^...^.^.....^.....^...^.^.^......................
.............................................................................................................................................
.....................^...^.^.^.....^.....^...^.....^.^.^.^.^.^.^.^...^.^...^.^.^.^.^.^.^.^.^.....^.^.^.^.....^.^...^.^.^.....................
.............................................................................................................................................
....................^.^.^.^.^...^.....^.^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^...^...^...^.^.^.^.....^.^.....^.^.^.^.^.^....................
.............................................................................................................................................
...................^.^.^.^.^.^.^.^.....^.^.^.^.^.^.^.^.^.......^.^.^.^.^.^...^.^.^...^.......^.^.^.^.^.^.^.^.^.^...^.^.^.^...................
.............................................................................................................................................
..................^...^.^.^.^...^.^.^.^.....^...^.^.^.^.^.^...^...^.^.^...^...^.....^.^.^.^.....^...^.^...^...^.....^.^.^.^..................
.............................................................................................................................................
.................^.^...^...^.^.....^...^.^.^.^.^.^.^...^.^...^...^.^...^.^.^.^.^.^...^.^.....^.^.^.^...^.^.^.^...^.^.......^.................
.............................................................................................................................................
................^...^.^.....^.^...^.^.^.^.^.^.^.^.^.^...^.^.......^.^.^.^.^.^.^.....^.^.....^.^.^...^.^.^...^.^...^...^.^.^.^................
.............................................................................................................................................
...............^.^...^.^.^...^...^.^.^.^.....^.^.^...^...^.^.^.^.^...^.........^...^.^.^.^...^.^.^.^...^.^.^...^.^...^.^.^.^.^...............
.............................................................................................................................................
..............^.^...^.^.^...^...^.^.^.^.^.^.^.....^.^.^...^...^...^.^.^...^.....^...^.^.^.^.....^...^.....^...^.^.^.^.^.....^.^..............
.............................................................................................................................................
.............^.^.^.^.^.^.^.....^.^.^.^.^.^.^.^.^...^.....^.^.^.^...^...^.^.^...^.^.^...........^.^.^...^.^.......^...^.^.^.^...^.............
.............................................................................................................................................
............^.^.^.^.......^.^.^.^.....^...^.^.^...^.^.^.^.^.^.^...^...^.^.^.^...^.^.^.^.^.^.........^...^.^.^.^.^.^...^...^.^.^.^............
.............................................................................................................................................
...........^.^.^.^...^.^.^...^...^...^...^.^.^.^.^.^.^.^.^.^...^...^...^...^.^.^.^.^.^.....^.^.^.^.........^.^.^...^.^.^.^.....^.^...........
.............................................................................................................................................
..........^.^.^...^.^.^.^.^.^.^.^.....^.^.....^.^...^.^...^...^.^...^.^.^...^.^.^.^.^.^.^.....^...^.^.^.^.^.^.......^.^.^.^.^.^.^.^..........
.............................................................................................................................................
.........^...^.^...^.......^...^.^...^...^...^.^.^...^...^.^.^.^.^.....^.....^...^.^...^.^.^.^...^.^.^.^.^.....^.^...^.^.^.^...^.^.^.........
.............................................................................................................................................
........^.^.^.^.^.........^.....^.^.....^...^.......^.^.^.^.......^...^.^...^.^.^.^.^.^.^...^.^...^...^.......^.^.^.^.^.^.^.^...^...^........
.............................................................................................................................................
.......^.^.^.^...^...^.....^.^.^.....^.^.^.^.^.....^...^.^.^.^.^.^.....^.^.^.^...^.^.^.....^.......^.^.^...^.....^.^.^.^.^.^.^.^.....^.......
.............................................................................................................................................
......^.^.^.^.^.^.^.^.^.^.^.^.....^...^.^.^.^.^.^...^.^...^...^...^...^.^.^.^...^...^...^.^.....^.^...^.^.^.^.^...^.....^.^...^.^.^.^.^......
.............................................................................................................................................
.....^...^.^.^.^.^.^...^.^.^.^.^.^.^.^...^.^.....^.^.^.^.^.^.^.^.^.^.....^.^...^.^.^.^.^...^.^.^...^.^...^.....^...^.^.^.^.^.^.^.^.^...^.....
.............................................................................................................................................
....^.^.^...^.^...^.^.^...^.^...^...^.^...^.^.^...^...^...^.^.^.^.^.^.^.^.^.^.....^.^...........^...^.^.^.^.^...^.^...^.^.^...^...^.^.^.^....
.............................................................................................................................................
...^.^.^...^.^...^...^.^.^.^...^.^.^.^.^.^.^.^...^.^.......^.^.....^.^.^...^.^.^.^.^.^.^.^.^.^.........^.^.^.^...^.^.^.^.^.^.^...^.^.^...^...
.............................................................................................................................................
..^.^.^.^.^.^.^.^.^.^...^...^.....^...^.^.^.^...^...^.^...^.^.^.^.^...^.^.^...^.^.^.......^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.^...^.^.^.....^..
.............................................................................................................................................
.^.^.^.^.^.^...^.^.^.^.^...^.^...^.^...^.^.^...^.^.^...^.^.^.^.^.....^.^.......^.^.^.^.^.^.....^...^.^.^.^.^.^.^.^...^.^.^.....^.^...^.^...^.
.............................................................................................................................................
`

// Part One
const partOne = () => {
    const input = demo
        .replace('S', '|')
        .split('\n')
        .filter(line => line.length > 0)
        .map(line => line.split(''));

    let total = 0;

    for (let row = 0; row < input.length - 1; row++) {
        for (let col = 0; col < input[row].length; col++) {
            if (input[row][col] === '|') {
                if (input[row + 1][col] === '^') {
                    input[row + 1][col - 1] = '|';
                    input[row + 1][col + 1] = '|';

                    total++;
                } else {
                    input[row + 1][col] = '|';
                }
            }
        }
        // console.clear();
        // console.table(input);
    }

    return total
}

// Result
console.time("Part One");
console.log('Part One', partOne())
console.timeEnd("Part One");

// ------------------------------------------------
// ------------------------------------------------
// ------------------------------------------------
// Part Two
const partTwo = () => {
    const input = inputString
        .replace('S', '|')
        .split('\n')
        .filter(line => line.length > 0)
        .map(line => line.split(''));

    const timeline = Array.from({ length: input.length }, () =>
        Array(input[0].length).fill(0)
    );

    for (let r = 0; r < input.length; r++) {
        for (let c = 0; c < input[0].length; c++) {
            if (input[r][c] === '|') timeline[r][c] = 1;
        }
    }

    for (let row = 0; row < input.length - 1; row++) {
        for (let col = 0; col < input[row].length; col++) {

            if(timeline[row][col] === 0) continue;

            const nextRow = input[row + 1][col];
            if(nextRow === "^") {
                timeline[row + 1][col - 1] += timeline[row][col];
                timeline[row + 1][col + 1] += timeline[row][col];
            } else {
                timeline[row + 1][col] += timeline[row][col];
            }
        }
    }

    // console.table(timeline);
    const lastRow = timeline[timeline.length - 1];
    return lastRow.reduce((acc, curr) => acc + curr, 0)
}

// Result
console.time("Part Two");
console.log('Part Two', partTwo())
console.timeEnd("Part Two");
